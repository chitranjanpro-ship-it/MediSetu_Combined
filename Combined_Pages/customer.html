<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Customer Dashboard - MediSetu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-success">
  <div class="container">
    <a class="navbar-brand" href="index.html">MediSetu</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
        <li class="nav-item"><a class="nav-link" href="register.html">Register</a></li>
        <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
        <li class="nav-item"><a class="nav-link" href="partner.html">Partner</a></li>
        
        <!-- Dashboard Links -->
        <li class="nav-item"><a class="nav-link" href="customer.html" class="active">Customer</a></li>
        <li class="nav-item"><a class="nav-link" href="doctor.html">Doctor</a></li>
        <li class="nav-item"><a class="nav-link" href="vendor.html">Vendor</a></li>
        <li class="nav-item"><a class="nav-link" href="delivery.html">Delivery</a></li>
        <li class="nav-item"><a class="nav-link" href="logistics.html">Logistics</a></li>
      </ul>
    </div>
  </div>
</nav>

<section class="container py-5">
  <h2 class="mb-4 text-center">Customer Dashboard</h2>
  <div id="welcomeMsg" class="alert alert-info text-center"></div>

  <!-- Search Bar -->
  <div class="mb-5">
    <div class="input-group input-group-lg">
      <input type="text" class="form-control" id="medicineSearch" placeholder="Search Medicine...">
      <button class="btn btn-success" onclick="searchMedicine()">Search</button>
    </div>
    <div id="searchResults" class="mt-3"></div>
  </div>

  <div class="row g-4">
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <h5 class="card-title">Upload Prescription</h5>
          <p>Upload your prescription via file or camera.</p>
          <button class="btn btn-primary" onclick="showUploadModal()">Upload</button>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <h5 class="card-title">My Orders</h5>
          <p>Track your current and past orders.</p>
          <button class="btn btn-primary" onclick="showOrdersModal()">View Orders</button>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <h5 class="card-title">Reports Vault</h5>
          <p>Securely store and access lab/doctor reports.</p>
          <button class="btn btn-primary" onclick="showReportsModal()">View Reports</button>
        </div>
      </div>
    </div>
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm text-center">
        <div class="card-body">
          <h5 class="card-title">Consult Doctor</h5>
          <p>Chat or video consult with registered doctors.</p>
          <button class="btn btn-primary" onclick="showConsultModal()">Consult</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Promo Banner -->
  <div class="mt-5 p-4 text-center bg-light rounded shadow-sm">
    <h5>Save More with Branded vs Generic Medicines!</h5>
    <p>Switch & Save on your prescriptions today.</p>
  </div>
</section>

<!-- Upload Prescription Modal -->
<div class="modal fade" id="uploadModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Upload Prescription</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="prescriptionForm">
          <div class="mb-3">
            <label class="form-label">Upload Prescription File</label>
            <input type="file" class="form-control" id="prescriptionFile" accept="image/*,.pdf" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Doctor Name (Optional)</label>
            <input type="text" class="form-control" id="doctorName">
          </div>
          <div class="mb-3">
            <label class="form-label">Notes</label>
            <textarea class="form-control" id="prescriptionNotes" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-primary w-100">Submit Prescription</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Orders Modal -->
<div class="modal fade" id="ordersModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">My Orders</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Items</th>
                <th>Total</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="ordersTableBody">
            </tbody>
          </table>
        </div>
        <div id="noOrdersMsg" class="text-center text-muted" style="display: none;">No orders found.</div>
      </div>
    </div>
  </div>
</div>

<!-- Reports Modal -->
<div class="modal fade" id="reportsModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Reports Vault</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="reportUploadForm" class="mb-4">
          <div class="mb-3">
            <label class="form-label">Upload Report</label>
            <input type="file" class="form-control" id="reportFile" accept="image/*,.pdf" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Report Type</label>
            <select class="form-select" id="reportType" required>
              <option value="">--Select--</option>
              <option value="lab">Lab Report</option>
              <option value="doctor">Doctor Report</option>
              <option value="scan">Scan Report</option>
              <option value="other">Other</option>
            </select>
          </div>
          <button type="submit" class="btn btn-primary">Upload Report</button>
        </form>
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Report ID</th>
                <th>Type</th>
                <th>Date</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="reportsTableBody">
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Consult Doctor Modal -->
<div class="modal fade" id="consultModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Consult Doctor</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Select Doctor</label>
          <select class="form-select" id="doctorSelect">
            <option value="">--Select Doctor--</option>
            <option value="dr1">Dr. Sharma - General Physician</option>
            <option value="dr2">Dr. Patel - Cardiologist</option>
            <option value="dr3">Dr. Kumar - Dermatologist</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Consultation Type</label>
          <select class="form-select" id="consultType">
            <option value="chat">Chat Consultation</option>
            <option value="video">Video Consultation</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Describe your issue</label>
          <textarea class="form-control" id="consultIssue" rows="4"></textarea>
        </div>
        <button class="btn btn-success w-100" onclick="startConsultation()">Start Consultation</button>
      </div>
    </div>
  </div>
</div>

<footer class="bg-dark text-white text-center py-3">
  &copy; 2025 MediSetu. All rights reserved.
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/script.js"></script>
<script>
// Customer Dashboard Functionality
const currentUser = JSON.parse(localStorage.getItem('currentUser')) || {};

document.addEventListener('DOMContentLoaded', function() {
  if (currentUser.name) {
    document.getElementById('welcomeMsg').textContent = `Welcome, ${currentUser.name}!`;
  }
  loadOrders();
  loadReports();
});

// Medicine Search
function searchMedicine() {
  const query = document.getElementById('medicineSearch').value.trim();
  const resultsDiv = document.getElementById('searchResults');
  
  if (!query) {
    resultsDiv.innerHTML = '<div class="alert alert-warning">Please enter a medicine name.</div>';
    return;
  }
  
  // Sample medicine database
  const medicines = [
    { name: 'Paracetamol 500mg', price: '₹25', generic: '₹15', stock: 'In Stock' },
    { name: 'Amoxicillin 250mg', price: '₹45', generic: '₹28', stock: 'In Stock' },
    { name: 'Cetirizine 10mg', price: '₹35', generic: '₹22', stock: 'In Stock' },
    { name: 'Azithromycin 500mg', price: '₹120', generic: '₹75', stock: 'In Stock' }
  ];
  
  const filtered = medicines.filter(m => 
    m.name.toLowerCase().includes(query.toLowerCase())
  );
  
  if (filtered.length === 0) {
    resultsDiv.innerHTML = '<div class="alert alert-info">No medicines found. Try a different search term.</div>';
    return;
  }
  
  let html = '<div class="row g-3">';
  filtered.forEach(med => {
    html += `
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h6>${med.name}</h6>
            <p class="mb-1">Branded: ${med.price} | Generic: ${med.generic}</p>
            <span class="badge bg-success">${med.stock}</span>
            <button class="btn btn-sm btn-primary float-end" onclick="addToCart('${med.name}', '${med.generic}')">Add to Cart</button>
          </div>
        </div>
      </div>
    `;
  });
  html += '</div>';
  resultsDiv.innerHTML = html;
}

function addToCart(name, price) {
  alert(`${name} added to cart! Price: ${price}`);
}

// Upload Prescription
function showUploadModal() {
  const modal = new bootstrap.Modal(document.getElementById('uploadModal'));
  modal.show();
}

document.getElementById('prescriptionForm')?.addEventListener('submit', function(e) {
  e.preventDefault();
  const file = document.getElementById('prescriptionFile').files[0];
  const doctorName = document.getElementById('doctorName').value;
  const notes = document.getElementById('prescriptionNotes').value;
  
  if (!file) {
    alert('Please select a file');
    return;
  }
  
  const prescriptions = JSON.parse(localStorage.getItem('prescriptions')) || [];
  prescriptions.push({
    id: prescriptions.length + 1,
    fileName: file.name,
    doctorName: doctorName,
    notes: notes,
    date: new Date().toISOString(),
    status: 'Pending Review'
  });
  localStorage.setItem('prescriptions', JSON.stringify(prescriptions));
  
  alert('Prescription uploaded successfully! It will be reviewed shortly.');
  bootstrap.Modal.getInstance(document.getElementById('uploadModal')).hide();
  this.reset();
});

// Orders
function showOrdersModal() {
  const modal = new bootstrap.Modal(document.getElementById('ordersModal'));
  loadOrders();
  modal.show();
}

function loadOrders() {
  const orders = JSON.parse(localStorage.getItem('orders')) || [];
  const tbody = document.getElementById('ordersTableBody');
  const noOrders = document.getElementById('noOrdersMsg');
  
  if (orders.length === 0) {
    tbody.innerHTML = '';
    noOrders.style.display = 'block';
    return;
  }
  
  noOrders.style.display = 'none';
  tbody.innerHTML = '';
  orders.forEach(order => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>#${order.id}</td>
      <td>${new Date(order.date).toLocaleDateString()}</td>
      <td>${order.items}</td>
      <td>${order.total}</td>
      <td><span class="badge bg-${order.status === 'Delivered' ? 'success' : order.status === 'Processing' ? 'warning' : 'info'}">${order.status}</span></td>
    `;
    tbody.appendChild(tr);
  });
}

// Reports
function showReportsModal() {
  const modal = new bootstrap.Modal(document.getElementById('reportsModal'));
  loadReports();
  modal.show();
}

function loadReports() {
  const reports = JSON.parse(localStorage.getItem('reports')) || [];
  const tbody = document.getElementById('reportsTableBody');
  tbody.innerHTML = '';
  
  if (reports.length === 0) {
    tbody.innerHTML = '<tr><td colspan="4" class="text-center">No reports uploaded yet.</td></tr>';
    return;
  }
  
  reports.forEach(report => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>#${report.id}</td>
      <td>${report.type}</td>
      <td>${new Date(report.date).toLocaleDateString()}</td>
      <td><button class="btn btn-sm btn-info" onclick="viewReport(${report.id})">View</button></td>
    `;
    tbody.appendChild(tr);
  });
}

document.getElementById('reportUploadForm')?.addEventListener('submit', function(e) {
  e.preventDefault();
  const file = document.getElementById('reportFile').files[0];
  const type = document.getElementById('reportType').value;
  
  if (!file || !type) {
    alert('Please fill all fields');
    return;
  }
  
  const reports = JSON.parse(localStorage.getItem('reports')) || [];
  reports.push({
    id: reports.length + 1,
    fileName: file.name,
    type: type,
    date: new Date().toISOString()
  });
  localStorage.setItem('reports', JSON.stringify(reports));
  
  alert('Report uploaded successfully!');
  loadReports();
  this.reset();
});

function viewReport(id) {
  const reports = JSON.parse(localStorage.getItem('reports')) || [];
  const report = reports.find(r => r.id === id);
  if (report) {
    alert(`Report #${report.id}\nType: ${report.type}\nFile: ${report.fileName}\nDate: ${new Date(report.date).toLocaleDateString()}`);
  }
}

// Consult Doctor
function showConsultModal() {
  const modal = new bootstrap.Modal(document.getElementById('consultModal'));
  modal.show();
}

function startConsultation() {
  const doctor = document.getElementById('doctorSelect').value;
  const type = document.getElementById('consultType').value;
  const issue = document.getElementById('consultIssue').value;
  
  if (!doctor) {
    alert('Please select a doctor');
    return;
  }
  
  alert(`Consultation request submitted!\nDoctor: ${doctor}\nType: ${type}\nYour consultation will start shortly.`);
  bootstrap.Modal.getInstance(document.getElementById('consultModal')).hide();
}

// Enter key for search
document.getElementById('medicineSearch')?.addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    searchMedicine();
  }
});
</script>
</body>
</html>
